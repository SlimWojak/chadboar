# ChadBoar — Risk Configuration
# Read by Python guards at runtime.

# Portfolio limits
portfolio:
  starting_balance_sol: 14.0   # Funded 2026-02-10
  max_concurrent_positions: 5
  daily_exposure_pct: 30       # Max 30% of pot deployed per day (INV-DAILY-EXPOSURE-30)
  drawdown_halt_pct: 50        # Halt if pot < 50% of starting (INV-DRAWDOWN-50)
  drawdown_halt_hours: 24      # Hours to halt after drawdown trigger

# Per-trade limits
trade:
  auto_max_usd: 50             # Auto-execute up to this amount
  convergence_max_usd: 100     # 2+ signals required up to this amount
  human_gate_usd: 100          # Above this → alert G, await approval (INV-HUMAN-GATE-100)
  slippage_max_pct: 3          # Jupiter slippage parameter
  max_position_pct: 5          # Maximum 5% of pot per trade

# Conviction scoring — dual profiles for graduation vs accumulation plays
conviction:
  # Signal weights (max points per signal) — ACCUMULATION profile (default)
  weights:
    smart_money_oracle: 40     # +15 per whale, cap 40 (3+ whales)
    narrative_hunter: 30       # Volume spike >5x + KOL detection, decay after 30min
    rug_warden: 20             # Binary: PASS = +20, FAIL = instant veto
    edge_bank: 10              # Similar setup match >70% from past winners (0 until 10+ beads)

  # GRADUATION profile — Pulse-sourced speed plays (PumpFun → Raydium migration)
  weights_graduation:
    pulse_quality: 35          # Organic ratio, pro trader %, ghost metadata
    narrative_hunter: 30       # Volume spike + KOL (social confirmation)
    rug_warden: 25             # Higher weight — less data = need more safety assurance
    smart_money_oracle: 0      # Structurally unavailable for new tokens (neutral, not penalty)
    edge_bank: 10              # Same as accumulation (0 until 10+ beads, redistributed to warden)

  # Thresholds (tuned for tiny-cap scalps — let the boar trade and learn)
  thresholds:
    auto_execute: 75           # ≥75: accumulation auto-execute (was 85 — too high, nothing trades)
    auto_execute_graduation: 50  # ≥50: graduation auto-execute (was 55 — WARN tokens with good pulse need to trade)
    watchlist: 40              # 40+: watchlist (was 45 — let more candidates onto radar)
    paper_trade: 25            # 25-39: paper trade (was 30 — more paper trades = more beads = faster learning)
    discard: 25                # <25: discard, no alert

  # Edge bank cold start: disabled until this many beads exist
  edge_bank_min_beads: 10      # Below this, edge_bank points redistributed to rug_warden

  # Graduation play limits (smaller bets × more trades = more beads = faster learning)
  graduation:
    max_position_usd: 30       # Hard cap per graduation trade (was 50 — smaller bets, more swings)
    max_daily_plays: 8         # Max graduation trades per day (was 3 — let the boar trade and learn)
    bonded_stage_bonus: 5      # Extra points for freshly graduated (bonded) tokens

  # Position sizing parameters
  sizing:
    base_multiplier: 0.01      # (score/100) × (pot × 0.01)
    # volatility_factor calculated dynamically, defaults to 1.0

# Exit tiers (applied in watchdog step) — ACCUMULATION default
exits:
  take_profit:
    tier_1_pct: 50             # Exit 50% position at 2x
    tier_1_multiple: 2.0
    tier_2_pct: 30             # Exit 30% position at 5x
    tier_2_multiple: 5.0
    trailing_stop_pct: 20      # Trail remainder at 20% below peak

  stop_loss_pct: 20            # Exit 100% at -20% (unchanged from trade.stop_loss_pct)

  time_decay:
    no_momentum_minutes: 60    # If no price movement after 60min → exit

# Exit tiers — GRADUATION speed plays (tighter, faster)
exits_graduation:
  take_profit:
    tier_1_pct: 50             # Exit 50% at 2x (same as accumulation)
    tier_1_multiple: 2.0
    tier_2_pct: 30             # Exit 30% at 3x (tighter than 5x — take profit faster)
    tier_2_multiple: 3.0
    trailing_stop_pct: 30      # Wider trail — graduation moves are volatile

  stop_loss_pct: 25            # Wider stop — more noise in early graduation plays

  time_decay:
    no_momentum_minutes: 30    # If no move in 30min, the graduation play is done

# Rug Warden thresholds — ACCUMULATION (established tokens)
rug_warden:
  min_liquidity_usd: 10000     # Reject if liquidity < $10k
  max_holder_concentration_pct: 80  # Reject if top 10 wallets > 80%
  min_token_age_seconds: 300   # Warn if token < 5 min old
  reject_mutable_mint: true    # Reject if mint/freeze authority is mutable
  reject_unlocked_lp: false    # Warn (not reject) if LP not locked/burned

# Rug Warden thresholds — GRADUATION (PumpFun → Raydium, pre-graduation scalps)
# These are asymmetric plays: small bet, high upside, accept more risk.
# PumpFun tokens are young, concentrated, and LP is never locked — that's normal.
rug_warden_graduation:
  min_liquidity_usd: 3000      # PumpFun graduates with $3-20k liq — $3k floor
  max_holder_concentration_pct: 95  # Early tokens always concentrated — WARN not FAIL above this
  min_token_age_seconds: 120   # Warn if < 2 min (graduation window is 2-10 min)
  reject_mutable_mint: true    # Still reject mutable mint — this is a real rug vector
  reject_unlocked_lp: false    # PumpFun LP is never locked — don't even warn

# Scalp mode — tight exits for pulse quick scanner auto-trades
scalp:
  enabled: true
  max_mcap_usd: 50000          # Only scalp sub-$50K mcap tokens
  take_profit_pct: 20           # Exit 100% at +20%
  stop_loss_pct: 0              # DISABLED — time decay is the stop loss, not price chop
  time_decay_minutes: 15        # Force exit if no +5% move in 15 min (this IS the SL)
  max_concurrent: 3             # Max 3 open scalp positions
  max_position_usd: 10          # $10 max per scalp (tiny learning bets)
  slippage_bps: 500             # 5% slippage tolerance (low-liq tokens)

# Circuit breakers
circuit_breakers:
  consecutive_losses: 3        # After 3 consecutive losses → reduce size 50%
  daily_loss_pct: 10           # If daily loss > 10% of pot → halt for rest of day
  rpc_failures: 5              # After 5 consecutive RPC failures → alert G
